# 加强内容多样性的推荐系统算法开发

## 目录

# 摘要
# Abstract
# 1. 前言
## 1.1 研究背景与意义
### 1.1.1 推荐系统发展概况
### 1.1.2 内容多样性的重要性

## 1.2 本文研究内容

## 1.3 本文的组织结构

# 2. 推荐系统基础理论与关键技术
## 2.1 推荐系统基本概念

## 2.2经典推荐算法
### 2.2.1 基于内容的推荐
### 2.2.2 协同过滤算法
### 2.2.3 混合推荐方法

## 2.3 现代推荐技术
### 2.3.1 基于深度学习的推荐模型
### 2.3.2 双塔模型架构

## 2.4 推荐系统面临的挑战

## 2.5 本节小结

# 3.推荐多样性研究综述
## 3.1 多样性问题概述
### 3.1.1 多样性的定义
### 3.1.2 多样性增强的意义

## 3.2 多样性增强方法
### 3.2.1 最大边际相关度（MMR）算法
### 3.2.2 行列式点过程（DPP）算法

## 3.3 本节小结

# 4.系统设计与算法实现
## 4.1 系统设计概述
### 4.1.1 设计目标
### 4.1.2 系统架构与模块划分
## 4.2 数据集与预处理
### 4.2.1 MovieLens和Anime数据集介绍
### 4.2.2 数据清洗与特征构建
## 4.3 基础推荐模块实现
### 4.3.1 用户相似度计算方法
### 4.3.2 评分预测与推荐生成
## 4.4 多样性算法实现
### 4.4.1 MMR算法设计与实现
### 4.4.2 DPP算法设计与实现
## 4.5 关键技术难点与解决方案
# 5. 实验评估与结果分析
## 5.1 实验设计
### 5.1.1 评价指标设计
### 5.1.2 实验环境与参数配置
### 5.1.3对照实验方案
## 5.2 实验结果
### 5.2.1 准确性评估（RMSE、NDCG等）
### 5.2.2 多样性评估（ILS多样性、类别多样性）
## 5.3 结果分析与讨论
### 5.3.1 MMR与DPP算法比较
### 5.3.2 多样性与准确性权衡分析
### 5.3.3 实验启示与改进方向
# 6. 总结与展望
## 6.1 研究工作总结
## 6.2 存在的问题与不足
## 6.3未来工作展望
<br>

# 加强内容多样性的推荐系统算法开发
【摘要】随着信息技术的飞速发展，推荐系统已广泛应用于电商、视频、音乐等领域，成为解决信息过载问题的重要手段。然而，传统推荐算法在追求准确性的同时，常常忽视内容的多样性，导致推荐结果趋同、用户体验下降，甚至形成“信息茧房”效应。因此，提升推荐系统的内容多样性，已成为当前研究的热点与挑战之一。<br>
本论文围绕“如何在保证推荐准确性的基础上有效提升内容多样性”这一核心问题，综合运用了协同过滤（Collaborative Filtering）、最大边际相关度（MMR, Maximal Marginal Relevance）以及行列式点过程（DPP, Determinantal Point Process）等算法，构建了一个具有多样性增强能力的推荐系统。在系统实现方面，本文以MovieLens和anime数据集为基础，完成了包括数据预处理、基础推荐构建、多样性重排序等模块的设计与开发。在多样性增强阶段，分别实现了基于相关性和新颖性权衡的MMR算法以及基于子集选择概率优化的DPP方法，并通过实验验证其在提升推荐列表多样性方面的有效性。<br>
实验部分对推荐结果的准确性（如RMSE、NDCG）与多样性（如ILS指标、类别覆盖率）进行了系统评估。结果表明：与仅使用协同过滤算法的推荐系统相比，引入MMR与DPP后能在多样性指标上获得显著提升，同时保持较高的准确性。在此基础上，论文还探讨了多样性与准确性的平衡问题，并对两类算法的应用场景进行了比较分析。<br>
本文的研究不仅丰富了推荐系统多样性增强的技术路径，也为实际应用中构建更加智能化、个性化的推荐系统提供了理论与实践参考。<br>
【关键词】推荐系统；内容多样性；协同过滤；最大边际相关度（MMR）；行列式点过程（DPP）

# Developing recommendation system algorithms to enhance content diversity
【Abstract】With the rapid advancement of information technology, recommender systems have become widely used in domains such as e-commerce, video streaming, and online entertainment, serving as a key solution to the problem of information overload. However, traditional recommendation algorithms often focus heavily on accuracy while overlooking content diversity, resulting in homogeneous recommendations, reduced user satisfaction, and even the emergence of “information cocoons.” Enhancing content diversity has thus become an important and challenging research focus.<br>
This thesis investigates how to improve recommendation diversity without significantly compromising accuracy by integrating Collaborative Filtering (CF), Maximal Marginal Relevance (MMR), and Determinantal Point Process (DPP) algorithms. A diversity-aware recommendation system is developed based on the MovieLens and Anime datasets, including modules for data preprocessing, baseline recommendation generation, and diversity-enhancing re-ranking. The MMR algorithm balances item relevance and novelty, while DPP promotes diversity through probabilistic modeling of item subsets.<br>
Extensive experiments are conducted to evaluate both recommendation accuracy (e.g., RMSE, NDCG) and diversity (e.g., Intra-List Similarity, category coverage). The results demonstrate that incorporating MMR and DPP significantly enhances diversity metrics while maintaining competitive accuracy compared to CF-only baselines. Furthermore, the thesis analyzes the trade-off between diversity and accuracy and provides comparative insights into the practical use of MMR and DPP.<br>
This research enriches the technical landscape of diversity-aware recommender systems and offers valuable theoretical and practical guidance for building more personalized and intelligent recommendation applications.<br>
【Key words】Recommender Systems; Content Diversity; Collaborative Filtering; Maximal Marginal Relevance (MMR); Determinantal Point Process (DPP)

# 1. 前言
## 1.1 研究背景与意义
### 1.1.1 推荐系统发展概况
随着信息技术的飞速发展，用户面对的信息过载问题愈发严重。推荐系统作为个性化信息过滤的重要技术，已经广泛应用于电子商务、社交平台、视频点播、新闻资讯等领域。其核心思想是根据用户的历史行为和兴趣偏好，从海量内容中筛选出最有可能感兴趣的项目，为用户提供高效、精准的服务[1]。<br>
推荐系统从最初基于规则和专家知识驱动，发展至以协同过滤为代表的数据驱动方法。近年来，随着深度学习、图神经网络（GNN）、强化学习等技术的引入，推荐系统逐步向高维建模、实时反馈、自适应优化等方向演进，推荐准确性显著提升。<br>
然而，推荐系统过度追求准确率的同时，也带来了内容同质化、兴趣局限性增强等问题，导致用户长期暴露于有限类型的信息中，形成“信息茧房”与“回音室效应”，削弱了推荐系统的探索性与用户体验[2]。
### 1.1.2 内容多样性的重要性
在信息检索与推荐系统领域，结果多样性不仅是一个技术指标，更是影响系统整体效能和用户体验的关键因素。高多样性的推荐结果能够产生多方面的积极影响[3]：<br>
多样性能够有效避免信息冗余，显著提升推荐列表的覆盖广度。当系统仅关注结果的相关性时，往往会产生内容高度相似的推荐项，这种冗余会直接降低推荐列表的信息量。通过引入多样性机制，系统可以在保证核心相关性的同时，覆盖更广泛的内容维度，从而为用户提供更具信息价值的结果集合。<br>
多样性机制能够增强系统的探索能力，促进用户兴趣的拓展。在推荐系统场景下，过度专注于用户已知兴趣的" exploitation"策略可能导致推荐内容逐渐趋同，形成信息茧房。而适当的多样性引入可以平衡"exploration"与"exploitation"，帮助用户发现潜在感兴趣的新内容领域，实现兴趣边界的自然扩展。<br>
除此之外，多样性策略还能够显著增加长尾内容的曝光机会，这对平台内容生态建设具有重要意义。在传统的推荐机制下，热门内容往往获得不成比例的曝光量，而大量优质长尾内容难以获得展示机会。通过设计合理的多样性算法，可以为小众内容创造公平的展示机会，促进平台内容生态的健康发展。<br>
从长期效果来看，多样性推荐能够提高用户留存率并增强对平台的信任感。单调重复的推荐内容容易导致用户疲劳，而富有变化且具有发现性的推荐体验则能持续吸引用户。同时，当用户感知到平台推荐的内容丰富且不偏颇时，会建立更强的使用粘性和信任感。这种长期效应对于商业推荐系统尤为重要。<br>
Carbonell和Goldstein[4] 首次将“最大边际相关度（MMR）”用于文档重排序，提出在相关性与多样性之间权衡的思想，对后续推荐系统的多样性研究产生了深远影响。而近年来如Borodin 等 [5] 提出的最大和多样化问题、Chen等 [6] 对 DPP 的高效推断优化，使得推荐系统在多样性目标建模与求解效率上取得重要突破。<br>
因此，如何在保障推荐相关性的同时提升内容的多样性，已成为现代推荐系统不可或缺的研究方向。

## 1.2 本文研究内容
本文围绕“提升推荐系统内容多样性”的核心目标，结合协同过滤算法与典型多样性增强技术（MMR与DPP），构建了一个具备准确性与多样性双优化能力的推荐系统。主要研究工作如下：<br>
（1）系统设计与实现：在协同过滤基础上，集成MMR与DPP作为后排序机制，实现推荐结果的多样性控制。<br>
（2）算法对比与参数调优：基于两个不同结构的数据集（MovieLens与Anime），分析MMR与DPP在不同θ值下的性能变化。<br>
（3）评估体系构建：通过NDCG、ILS、类别覆盖率等指标，可视化分析准确性与多样性的权衡效果。<br>
（4）实验与验证：在真实数据集上对所提方法进行系统实验，验证其在实际应用中的可行性与实用性。<br>

## 1.3 本文的组织结构
本文共分六章，各章节内容如下：<br>
- 第1章：介绍推荐系统的发展背景、内容多样性的重要性、本文研究内容、本文组织结构，为后续章节奠定理论基础和研究动机。
- 第2章：系统梳理推荐系统的基本概念，回顾协同过滤、基于内容的推荐、混合推荐等经典算法，并介绍现代深度学习推荐模型及双塔架构，为算法实现提供理论支撑，总结当前推荐系统所面临的挑战。
- 第3章：概述多样性问题，提出多样性定义及其增强意义，并详细介绍最大边际相关度（MMR）和行列式点过程（DPP）等多样性增强方法，分析各方法优缺点。
- 第4章：描述推荐系统的整体设计目标、系统架构与模块划分，详细介绍数据集与预处理流程，基础协同过滤推荐模块的实现，以及MMR和DPP多样性算法的设计与实现。最后总结关键技术难点及解决方案。
- 第5章：介绍实验设计、评价指标、实验环境与参数配置，给出对照实验方案。系统展示准确性与多样性评估结果，深入分析MMR与DPP算法的表现及多样性与准确性的权衡关系，并提出实验启示与改进方向。
- 第6章：总结全文的主要研究工作，分析存在的问题与不足，展望未来在个性化多样性调节、多源信息融合、多目标优化、高效系统设计及真实场景验证等方向的研究前景。

# 2. 推荐系统基础理论与关键技术
## 2.1 推荐系统基本概念
推荐系统是一类通过对用户历史行为数据或物品属性信息进行建模分析，进而预测用户潜在兴趣并向其推荐相关内容的智能系统。其核心在于算法模型的构建，该模型通过挖掘用户与物品之间的潜在关联关系，实现对用户偏好的准确预测[7]。<br>
推荐系统在各类应用场景中得到了广泛部署。在电子商务平台中，推荐系统能够根据用户的浏览记录、购买行为等历史数据，为其推荐可能感兴趣的商品，从而提升用户的购物体验与转化率；在社交媒体环境下，推荐系统则结合用户的兴趣标签与社交网络结构，为其推荐内容或潜在社交关系，增强用户粘性与平台活跃度；在新闻资讯类网站中，推荐系统依据用户的点击历史与偏好特征，推送个性化新闻内容，提高用户的阅读满意度与停留时间。图2-1为搜狐网个性化推荐界面。<br>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/2.1.png" width="400"/>
</div>
<p align="center">图2-1 搜狐网个性化推荐界面</p>

随着推荐系统在实际应用中的广泛部署，其底层算法体系也逐渐形成了系统化的分类结构。根据推荐算法的实现原理及所依赖的信息来源，推荐方法大致可分为三类[7]：基于内容的推荐、基于协同过滤的推荐，以及结合多种策略的混合推荐方法。这些经典方法构成了推荐系统发展的基础，其核心在于利用已有的用户行为或物品信息，挖掘用户兴趣偏好，从而实现个性化推荐。<br>
在此基础上，近年来随着深度学习等人工智能技术的兴起，推荐系统也逐步迈入智能化建模的新阶段，涌现出一系列现代推荐技术，如基于深度学习的推荐模型以及双塔结构的表示学习方法，极大地提升了模型的特征表达能力与推荐效果。<br>

## 2.2经典推荐算法
### 2.2.1基于内容的推荐
基于内容的推荐[8]是一种广泛应用于个性化推荐系统的方法，其核心思想是通过分析物品本身的内容特征，结合用户的历史偏好，为用户推荐与其兴趣相似的物品。基于内容的推荐更加注重物品特征的建模，因而在推荐系统中具有独特优势。<br>
该方法通常包括以下几个关键步骤[7]：<br>
（1）内容表示：首先需要对物品的内容进行特征化处理。针对不同类型的内容（如文本、图像、音频或视频），可采用相应的信息抽取技术进行表示。例如，对文本类物品可使用自然语言处理方法提取关键词、主题分布或情感特征；对图像和音频类物品，则可使用计算机视觉或音频信号处理技术提取视觉与声学特征。<br>
（2）用户建模：通过分析用户的历史行为（如点击、评分、浏览、收藏等）和偏好特征，构建用户兴趣画像。通常以用户过去偏好物品的特征作为其兴趣向量，以此反映其在内容维度上的倾向性。<br>
（3）相似度计算：在获得物品和用户的表示后，系统会计算候选物品与用户兴趣之间的相似度，常用的方法包括余弦相似度、欧几里得距离等，用于度量内容空间中的相近性。<br>
（4）候选集生成与排序：根据相似度得分生成候选推荐列表，并可结合其他因素如物品受欢迎程度、用户的个性化权重等进行排序，最终形成推荐结果。<br>

在电影推荐场景下，基于内容的推荐算法如图2-2所示，一名用户喜欢克里斯托弗·诺兰导演的《星际穿越》，那么该用户也可能对同样由诺兰执导、风格类似的《盗梦空间》感兴趣，系统便会将《盗梦空间》推荐给该用户。<br>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/2.2.png" width="400"/>
</div>
<p align="center">图2-2 基于内容的推荐算法图示</p>
基于内容的推荐算法具有一定的可解释性和冷启动友好性，尤其在用户历史行为较丰富的场景下，能够有效地推荐具有相似特征的新物品。但该方法也存在一定局限性，例如对物品内容表示的依赖较强，难以捕捉用户的深层兴趣偏好；此外，由于推荐策略倾向于推荐与用户已知兴趣相近的物品，可能造成推荐结果的多样性不足，易陷入“信息茧房”效应。

### 2.2.2 协同过滤算法
协同过滤算法是一类在推荐系统中应用广泛的经典推荐方法，它是基于用户与物品之间的交互行为（如评分、浏览、点击等），挖掘用户或物品之间的潜在相似性，从而为用户推荐可能感兴趣的物品[9]。与基于内容的推荐不同，协同过滤不依赖于物品本身的内容语义特征，而是依托于用户群体的行为数据，因而被称为“协同”推荐。<br>
协同过滤算法主要分为两类：基于领域和基于模型[10]，我们主要对基于领域的两种协同过滤算法进行探究——基于用户的协同过滤（User-Based Collaborative Filtering，User-CF）和基于物品的协同过滤（Item-Based Collaborative Filtering，Item-CF）[10]。<br>
（1）基于用户的协同过滤<br>
基于用户的协同过滤主要通过计算用户之间的兴趣相似度，为目标用户找到“兴趣邻居”——即在历史行为（如点赞、收藏、转发等）中表现出相似偏好的其他用户，然后推荐这些相似用户喜欢但目标用户尚未接触过的物品。图2-3是User-CF算法的思想图示。其中实线表示用户对该物品感兴趣，虚线表示User-CF根据用户兴趣相似度为用户推荐的物品。用户1和用户2有两个共同兴趣物品，则当用户1、用户2需要个性化推荐时，User-CF会将用户未接触的物品但相似用户喜欢的物品推荐给他们。<br>

<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/2.3.png" width="400"/>
</div>
<p align="center">图2-3 User-CF算法思想图示</p>

基于用户的协同过滤步骤如下[11]：
1. 系统采集用户对物品的行为数据（如评分、浏览记录等），以此构建用户-物品的交互矩阵。
2. 使用各用户对物品的偏好向量，计算目标用户和其他用户的兴趣相似度，常用相似度方法如余弦相似度、皮尔逊相关系数等。
3. 从所有用户中选出与目标用户相似度最高的k位“兴趣邻居”，筛选出邻居偏好物品中评分较高且目标用户未接触过的前n个物品，推荐给目标用户。

（2）基于物品的协同过滤<br>
基于物品的协同过滤是预先根据所有用户的历史偏好数据计算物品之间的相似性，然后把与用户喜欢的物品相类似的物品推荐给用户。图2-4是Item-CF算法的思想图示。实线表示用户对该物品感兴趣，虚线表示Item-CF根据物品相似度为用户推荐的物品。物品2与物品3同时被用户1和用户2喜欢，从用户-物品交互角度上较为相似，那么Item-CF会根据物品相似度将物品2推荐给未接触过的用户3。<br>

<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/2.4.png" width="400"/>
</div>
<p align="center">图2-4 Item-CF算法思想图示</p>

基于物品的协同过滤步骤如下[11]：
1. 系统采集用户对物品的行为数据，构建用户-物品交互矩阵
2. 使用各个物品与所有用户间的交互向量，计算物品相似度矩阵。
3. 对于目标用户，根据其历史行为中喜欢的物品，寻找与其相似度较高的前k个物品，从中选出用户未接触的前n个物品，推荐给用户。

### 2.2.3 混合推荐方法
基于内容的推荐算法与协同过滤算法在实际应用中取得了良好效果，但各自仍存在缺陷。前者在特征依赖性强、难以挖掘用户潜在兴趣方面存在不足，容易导致推荐结果过于同质化[12]；而后者则受限于数据稀疏性和冷启动问题[13]，特别是在用户或物品信息不足的情况下，推荐效果容易下降。<br>
为克服单一推荐方法的局限，提升推荐系统的综合性能，研究者提出了混合推荐算法（Hybrid Recommendation）。该方法通过将多种推荐策略有机结合，在充分发挥各自优势的同时，有效弥补了其不足，从而提高了推荐的准确性、覆盖率和多样性。
混合推荐算法主要类别为以下7类[14]：
1. 加权混合（Weighted Hybrid）<br>
加权混合推荐是混合推荐算法中最为常见的，其将多个推荐算法生成的结果进行加权融合。每种算法生成的评分或推荐列表按预设或动态计算的权重进行整合，常用于评分预测或排序任务。例如，将协同过滤和内容推荐结果分别赋予一定权重后综合排序。
2. 级联混合（Cascade Hybrid）<br>
级联混合是分阶段推荐过程的典例。先使用一种算法生成初步候选集，再用另一种算法对候选集进一步精细排序或过滤。
3. 切换式混合（Switching Hybrid）<br>
在切换式混合中，系统根据一些标准选择不同的推荐算法。例如，若用户历史数据稀疏时使用内容推荐，数据充足时则使用协同过滤。切换机制可以基于启发式规则或机器学习策略。
4. 特征组合（Feature Combination）<br>
将一种推荐方法的输出作为另一种方法的输入特征。比如将内容特征与用户行为特征一起输入到协同过滤模型中，形成更全面的用户画像。
5. 特征增强（Feature Augmentation）<br>
将某一推荐方法学习到的用户或物品模型，用作另一推荐模型的训练输入。例如，利用内容推荐构建的用户偏好向量，作为协同过滤的用户表示进行训练。
6. 元级别混合（Meta-Level Hybrid）<br>
一个推荐模型使用另一个模型生成的完整模型作为输入。例如先用内容推荐训练一个用户模型，再将该模型作为协同过滤算法的用户向量进行相似度计算。
7. 混合嵌套（Mixed Hybrid）<br>
同时并列展示多个推荐模型生成的结果，而不进行合并或排序。适用于需要体现多种推荐视角的场景，如在页面中同时显示“为你精选”、“热门推荐”、“与浏览记录相关”等板块。

## 2.3 现代推荐技术
### 2.3.1 基于深度学习的推荐模型
深度学习方法的不断成熟，使得研究者开始思考将神经网络引入推荐系统中，以提高推荐模型的表达能力与泛化性能。与传统推荐算法相比，深度学习推荐模型在处理高维稀疏数据、捕捉非线性关系以及建模复杂用户行为模式等方面展现出更强的适应性和鲁棒性。以下是几种常见典型模型[15]：

（1）神经协同过滤（Neural Collaborative Filtering, NCF）<br>
神经协同过滤模型是将神经网络框架与传统协同过滤思想相结合的一种方法。NCF通过将用户和物品的嵌入向量输入到多层感知机（MLP）中，从而捕捉非线性特征交互关系，克服了传统矩阵分解模型中交互关系建模能力有限的问题。该模型可以灵活扩展网络结构，适配不同复杂度的推荐任务，是深度学习推荐模型的代表性工作之一。

（2）Wide&Deep模型<br>
Wide&Deep模型由Google提出，是一种融合线性模型与深度神经网络的混合推荐结构。其中，Wide部分用于记忆特征与历史组合特征，适合拟合稀疏特征之间的共现关系；而Deep部分则利用神经网络对特征进行自动组合，挖掘潜在的高阶特征交互。该模型能够在保持推荐准确率的同时兼顾泛化能力，广泛应用于广告推荐与电商推荐系统中。

（3）深度矩阵分解（Deep Matrix Factorization）<br>
深度矩阵分解模型通过在传统矩阵分解框架中引入深层神经网络对用户和物品向量进行非线性转换，使模型具备更强的表示能力。其本质是利用深度结构对用户偏好空间进行映射，提升对复杂行为模式的建模效果。相比传统MF模型，深度矩阵分解在稀疏数据场景下表现出更优的推荐性能。

（4）基于卷积神经网络（CNN）的推荐模型<br>
CNN模型擅长提取局部特征，常被用于处理序列类推荐任务。在推荐系统中，基于CNN的方法通常用于建模用户的行为序列，能够有效捕捉局部偏好变化，例如短期兴趣跳转。通过在用户交互序列中滑动卷积窗口，模型可提取局部行为模式，并将其融合为用户兴趣表示，从而提高推荐的精度与上下文适应性。

（5）基于循环神经网络（RNN）的推荐模型
RNN模型特别适合处理时序信息，在建模用户兴趣随时间演化的任务中具有天然优势。基于RNN的推荐系统通过对用户历史行为序列进行递归建模，挖掘用户长期偏好与兴趣变化趋势。典型方法如GRU4Rec采用门控循环单元（GRU）结构，在会话推荐与行为预测任务中取得显著成效。

这些深度学习模型为推荐系统引入了更强的非线性建模能力与端到端学习结构，不仅提升了推荐的准确性，也为进一步整合多源异构数据提供了灵活手段。随着图神经网络、多模态建模等新技术的发展，深度推荐模型仍将持续推动个性化推荐系统的性能演进。

### 2.3.2 双塔模型架构
在深度学习推荐系统的发展中，双塔模型（Two-Tower Model）逐渐成为一种主流的模型结构，广泛应用于召回阶段或匹配阶段等高效推荐场景中。其基本思想源于2013年微软在CIKM会议上发表的论文[16],该论文提出了DSSM（Deep Structured Semantic Model），利用搜索引擎中用户点击日志中的Query与Document对，通过深度语义建模学习二者的语义相关性，有效提升了文本匹配与检索效果。随后，DSSM模型被进一步抽象和简化，形成了如今推荐系统中广泛应用的双塔结构。

在双塔模型的架构中[17]，通常将输入特征划分为两类：用户相关特征与物品相关特征，并分别送入左右两个独立的塔结构中进行建模。如下图2-5所示，左侧为用户塔，右侧为物品塔。
- 用户塔负责处理与用户有关的特征，如用户的基本信息（性别、年龄等）、行为历史（如点击、浏览、评分过的物品序列）、以及群体统计特征等。此外，一些上下文信息如时间、地点、设备类型等，也常常归入用户塔，以刻画用户在当前情境下的偏好。
- 物品塔则主要处理推荐目标物品的相关特征，包括物品的基本信息（如ID、名称）、属性信息（如类别、价格、时长等）等。

<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/2.5.png" width="400"/>
</div>
<p align="center">图2-5 推荐领域常用DSSM模型结构</p>

两个塔的结构通常为经典的深度神经网络（DNN）：首先将输入特征进行One-Hot编码或数值化处理，接着通过Embedding层映射为低维稠密向量，再依次输入到多层感知机（MLP）中，提取高阶特征。最终，用户塔输出用户的语义向量表示（User Embedding），物品塔输出物品的语义向量表示（Item Embedding）。

在训练阶段，模型通过计算用户和物品Embedding之间的相似度（通常为内积或余弦相似度）来表示用户对物品的偏好程度。其中，使用余弦相似度本质上是在内积的基础上对向量进行了模长归一化，使得相似度仅取决于向量的方向，而忽略其长度，从而更专注于用户与物品兴趣之间的匹配程度。

为了优化模型，使用户向量更接近正例物品向量、远离负例物品向量，通常采用以下几种损失函数进行训练：
- 交叉熵损失（Cross-Entropy Loss）：将推荐任务视为一个二分类问题，学习用户对物品是否感兴趣的概率。
- BPR损失（Bayesian Personalized Ranking Loss）：一种基于排序优化的损失函数，直接优化正负样本之间的排序。
- Hinge Loss：另一种常用于表示学习的损失形式，通过设定一个间隔值，使正负样本间的相似度差异大于该阈值。

总体而言，双塔模型凭借其高效性、可扩展性和解耦结构，已成为大规模推荐系统中的关键架构之一。

## 2.4 推荐系统面临的挑战
推荐系统在提升个性化服务水平、改善用户体验方面发挥了重要作用，但在实际应用过程中仍面临多方面的挑战。这些挑战不仅影响推荐效果的准确性和多样性，也制约了系统的可用性与可持续发展。典型挑战包括：冷启动问题、数据稀疏性与可扩展性、多样性、用户隐私问题等[7]。

1. 冷启动问题<br>
冷启动问题指推荐系统在面对新用户或新物品时，由于缺乏足够的历史行为数据，难以生成有效推荐结果的情况。根据主体不同，冷启动问题可分为：
- 新用户冷启动：系统尚不了解用户的偏好，难以生成个性化推荐。
- 新物品冷启动：新内容缺乏用户交互，难以判断其适配的用户群体。

2. 数据稀疏性与可扩展性问题<br>
推荐系统通常构建用户-项目交互矩阵作为建模基础，而现实中用户对物品的交互非常有限，导致矩阵极度稀疏。这种数据稀疏性使得协同过滤类算法难以有效计算相似度或挖掘潜在偏好，从而降低推荐的准确性和覆盖率。<br>
同时，随着用户数量和内容规模的不断增长，推荐系统需处理的数据量呈指数级增长，导致算法面临严峻的可扩展性问题。传统推荐方法在大规模场景下往往面临存储开销高、响应速度慢、计算复杂度高等瓶颈。

3. 多样性问题<br>
尽管推荐系统多以准确率为主要优化目标，但推荐内容的多样性（指推荐列表的内容差异，代表系统能否涵盖用户兴趣的多个维度或潜在兴趣领域）对于用户体验和系统长期效果具有不可忽视的价值。在注重准确率的系统中，往往出现热门内容推荐过度集中的现象，导致内容趋同、探索性不足，用户容易陷入“信息茧房”。<br>
当前，主流推荐算法对热门项目具有偏好倾向，导致推荐列表往往集中于“头部”物品，缺乏创新性与多样化。如何实现推荐的“准确与多样”的平衡，是推荐系统进一步优化的重要方向。因此，后续章节将专门探讨推荐系统中提升多样性的技术路径，重点介绍最大边际相关性（MMR）算法与行列式点过程（DPP）算法，并基于两个实际数据集对其效果进行实验对比与分析。

4. 用户隐私问题<br>
推荐系统在进行个性化建模时通常需要处理大量敏感信息，如用户的行为轨迹、兴趣偏好、设备信息等。这些信息在为用户提供个性化服务的同时，也带来了显著的隐私与安全风险。

## 2.5 本节小结
本章围绕推荐系统的基础理论与关键技术展开了系统性的阐述。首先，介绍了推荐系统的基本概念、核心目标以及在实际应用场景中的广泛部署，明确了推荐系统在个性化信息获取中的重要作用。随后，按照技术发展脉络，对经典推荐算法与现代推荐技术进行了分类与分析。

在经典方法中，基于内容的推荐强调对物品属性信息的建模，适用于内容清晰且结构化的场景；协同过滤算法则基于用户行为数据挖掘兴趣相似性，是实际应用最为广泛的技术之一；而混合推荐算法通过多策略融合，有效提升了系统的鲁棒性与性能表现。与此同时，随着深度学习的兴起，现代推荐技术不断涌现，代表性的神经网络模型如NCF、Wide&Deep、CNN/RNN结构和双塔架构，显著提升了模型的非线性表达能力与用户建模效果，成为当前推荐系统研究与实践的主流方向。

此外，本章还简要讨论了推荐系统在实际应用中所面临的关键挑战，包括冷启动、数据稀疏、可扩展性、用户隐私保护，以及推荐结果的多样性与新颖性等问题。其中，推荐多样性不足被认为是当前系统优化中亟需解决的重要难题，影响系统长期使用体验与用户兴趣拓展。

下一章将围绕“推荐多样性”这一核心问题展开深入研究，介绍常见的多样性增强算法及其在实际推荐系统中的实现方式与性能评估。

# 3.推荐多样性研究综述
## 3.1 多样性问题概述
在大多数推荐系统的构建过程中，推荐结果的准确性一直是核心优化目标。无论是早期的协同过滤算法，还是近年来基于深度学习的方法，其性能评估大多依赖于诸如点击率（CTR）、平均精度（Precision）、归一化折损累积增益（NDCG）等精度类指标。这种以用户-物品匹配度为唯一导向的优化策略，确实在短期内显著提升了用户满意度与平台转化效果。

在推荐系统的大规模部署过程中，“精度至上”的推荐策略逐渐暴露出显著局限性。推荐列表中往往重复推荐热门物品或用户已知项目，缺乏信息新意与探索性。这种内容趋同现象限制了用户兴趣拓展，也使得平台的“长尾内容”难以获得展示机会，从而造成用户体验下降和内容生态失衡[3]。

为缓解上述问题，研究者提出将多样性引入推荐系统的优化目标中。推荐多样性[18]通常是指推荐列表中项目之间的差异程度，反映了推荐系统能否覆盖用户的多元兴趣、提供更丰富的内容选择。提升多样性有助于增强用户的新鲜感与探索意愿，提升系统的用户粘性与长期使用价值。

下面将围绕推荐系统中的多样性问题展开系统性探讨，包括介绍多样性的基本定义及在推荐系统中的研究价值；其次介绍经典多样性增强方法最大边际相关度（MMR）算法与行列式点过程（DPP）算法；最后探讨比较各方法优势和劣势。

### 3.1.1 多样性的定义
在推荐系统中，多样性通常指的是推荐列表中物品之间的差异性程度[18]。其本质在于评估推荐结果是否能覆盖用户兴趣的多个维度，或是否包含来自不同类别、主题或风格的内容。相比于单一的兴趣维度覆盖，高多样性的推荐列表更可能引发用户兴趣的延展和探索，从而提升系统的吸引力。

推荐多样性可以从以下几个角度进行理解：
- 内容多样性：推荐物品在内容属性（如类别、标签、主题）上的分散程度。
- 用户兴趣覆盖度：推荐是否覆盖了用户兴趣模型中的多个偏好维度。
- 系统层面的整体多样性：多个用户之间推荐结果的差异程度（如新颖性、个性化程度）。

### 3.1.2 多样性增强的意义
多样性推荐算法在提升推荐系统质量、优化用户体验、促进商业增长、构建平台生态以及推动社会多元文化交流等方面具有重要意义[18]。
多样性推荐能够覆盖用户多元化的兴趣，打破内容同质化，提升用户的探索体验。它帮助用户发现新颖、有趣的内容，减少“信息茧房”现象，增强系统的吸引力和用户满意度。
对于商家，多样性推荐有助于精准推送产品，理解用户潜在需求，尤其是在长尾市场中，帮助小型商家与新兴领域获得更多曝光机会，提升销售转化率与市场份额。
平台通过多样化推荐提升用户留存与活跃度，避免内容集中化，优化内容生态。多样性推荐有助于吸引更多用户，增加广告投放的点击率和投资回报率。
从社会角度看，多样性推荐帮助打破信息壁垒，促进不同文化和思想的交流，为边缘群体提供展示机会，增强社会的包容性和文化多样性。

## 3.2 多样性增强方法
### 3.2.1 最大边际相关度（MMR）算法
1998年，Carbonell和Goldstein在其经典论文[4]中提出了最大边际相关性（Maximal Marginal Relevance, MMR）算法，旨在保留高相关性的基础上引入结果之间的差异性，减少冗余、提高推荐效果。MMR算法最初应用于文本摘要与文档重排序任务中，但其通用性强，现已广泛应用于个性化推荐、搜索重排、内容聚合等多种场景。其核心思想是，在生成推荐列表时，综合考虑两个维度的目标：
- 相关性：候选项与用户兴趣的匹配程度。
- 相似性：候选项与已选项之间的相似性。

换言之，MMR并不是简单选择最相关的内容，而是在“选取当前最相关的内容”与“避免与已推荐内容过于相似”之间寻找平衡。
1. MMR的基本选取策略可形式化定义如下[4]：

$$\mathrm{MMR}=\arg \max _ {d_ {i} \in R \backslash S} \left[\lambda \cdot Sim \left(d_ {i}, q \right) - (1 - \lambda) \cdot \max _ {d_ {j} \in S} Sim \left(d_ {i}, d_ {j}\right)\right]$$

其中：
- R：所有候选项目集合；
- S：当前已选出的推荐列表；
- R \ S：R中未选择的项目；
- q：用户兴趣表示（如查询、用户向量等）；
- $Sim \left(d_i,q\right)$：候选项与用户兴趣之间的相似度；
- $Sim \left(d_i,d_j\right)$：候选项与已选项之间的相似度；
- $\lambda \in \left[0, 1\right]$：权衡参数，控制相关性与多样性的取舍。
当λ趋近于1时，MMR倾向于选择最相关的内容；当λ趋近于0时，MMR更强调多样性。

2. MMR的典型执行流程如下：<br>
(1)初始化：设定候选集R、用户兴趣表示q、已选集S=∅。<br>
(2)迭代选取：在未被选中的候选项中，根据MMR公式选出当前最优项目。<br>
(3)更新已选集合：将选中的项目加入S，更新推荐列表。<br>
(4)重复迭代，直到推荐列表达到预定长度。<br>

3. MMR算法优势及劣势<br>
相较于传统的排序或推荐算法，MMR算法在实现推荐结果的多样性控制方面具有显著优势：
- 准确性与多样性的平衡能力：MMR算法通过引入可调节的平衡参数λ，在推荐准确性与内容多样性之间实现动态权衡，提升推荐列表的整体质量。
- 良好的可解释性：其基于“最大边际增益”的选择策略逻辑清晰，可从相关性与冗余性两个角度解释推荐项的被选中原因，有利于提升系统的透明度与用户信任度。
- 较强的鲁棒性：在面对部分异常数据或冗余样本时，MMR在筛选推荐项过程中具备一定的容错能力，有助于提升推荐结果的稳定性。

MMR算法在实际推荐场景中所暴露出劣势主要体现在：
- 计算复杂度较高：在每一步候选项选择中需计算与用户兴趣和已选项之间的相似度，尤其是在候选集规模较大时，可能带来较高的计算开销，影响实时性。
- 对数据稀疏较敏感：在用户历史行为稀疏或用户画像构建不完整的情况下，相关性与相似性计算的准确性下降，导致推荐效果不稳定。
- 缺乏全局最优建模能力：MMR采用贪心策略逐项选择推荐内容，虽然简洁高效，但难以全局最优地建模子集间的协同多样性。

### 3.2.2 行列式点过程（DPP）算法

确定性点过程（Determinantal Point Process, DPP）[19]最早源于物理领域，用于建模费米子之间的排斥性分布。由于其天生倾向于为差异性更高的项目集合分配更大概率，因此被广泛应用于需要多样性控制的任务中，如图像搜索、文档/视频摘要、tweet排序和产品推荐等。

DPP是一个概率模型，主要描述的是在一个离散集合中，每个子集出现的概率。DPP将复杂的概率计算转换成简单的行列式计算，通过核矩阵的行列式计算每一个子集的概率，提高了计算效率。下面为符号定义[6]：<br>
Z：表示集合；<br>
$L_{X,Y}$ ：表示矩阵L的子矩阵，由子集X和子集Y指定行、列构建。为表示简便，使用 $L_X$ 表示 $L_{X,X}$；<br>
$\det(L)$ ：表示矩阵L的行列式。

$\mathcal{P}$ 表示离散集合 $Z = \lbrace 1, 2, …, M \rbrace$ 上所有子集 $2^Z$ 的概率度量。当 $\mathcal{P}$ 给空集非零概率，对于每一个子集 $Y\subseteq Z$，存在一个矩阵 $\mathbf{L}\in\mathbb{R}^{M\times M}$ ，Y的概率为 $\mathcal{P}(Y)\propto\det(\mathbf{L}_Y)$ ，其中L为半正定实数矩阵, $\propto$ 表示正比。

为得到子集Y，通过最大后验概率（MAP）推断：

$$Y_{\mathrm{map}}=\arg\max_{Y\subseteq Z}\det(\mathbf{L}_{Y}).(式3-1)$$

为此，研究者们提出了多种近似推理方法。梯度优化虽然精度高，但不适用于实时推荐场景；贪婪算法则因其实用性强而被广泛采用。已有方法中，精确贪婪DPP推理的复杂度通常为O($M^4$)，部分近似方法可降至O($M^3$)，但会牺牲精度。Hulu在NIPS 2018 会议上发表的论文[6]提出了计算复杂度为O($M^3$) 的高效精确贪婪推理算法，在兼顾多样性与准确性的同时，显著提升了运行效率。

其求解过程为每次从候选集中贪心地选择一个边际收益最大的物品加入到最终的结果子集中，直到满足停止条件为止。即

$$j= \arg \max\mathrm{~logdet}(L_{Y_g\cup\lbrace i\rbrace})-\log \det(L_{Y_g})（式3-2）$$

被添加至结果集 $Y_g$ 中。选取过程中 $det(L_{Y_g})$ 计算复杂度高，可采用Cholesky分解简化运算。

下面对k-DPP应用于推荐系统重排证明推导过程[6]：<br>
精排给n个物品打分，它们的向量表征为 $v_{1}, \cdots, v_{n} \in \mathbb{R}^{d}$。目标选出k个物品，使其超平形体 $\mathcal{P}(v_1, \cdots, v_k)$ 的体积较大。计算n × n的相似度矩阵A，它是一个n × n的对称半正定矩阵。设集合S是[n]的子集，大小为k。定义 $A_S$ 是A的一个子矩阵，大小为k × k。<br>
k-DPP应用于推荐系统重排，具体求解以下优化问题：

$$\underset{\delta:|\delta|=k}{\arg\max}\theta\cdot\left(\sum_{i\in\mathcal{S}}reward_i\right)+(1-\theta)\cdot\mathrm{logdet}(\mathbf{A}_{\mathcal{S}})（式3-3）$$

该组合优化问题从n个物品中选出k个，用S表示已选中的物品，用R表示未选中的物品。使用Hulu的贪心算法分解每一步求解问题：

$$\arg\max_{i \in R} \lbrace \theta\cdot reward_i + (1 - \theta) \cdot \mathrm{logdet}(\mathbf{A}_{\mathcal{S\cup{\lbrace i \rbrace}}}) \rbrace.（式3-4）$$

由于 $A_S$ 是对称半正定矩阵，因此存在Cholesky分解 $A_{\mathcal{S}}=LL^{\top}$，L均为 $|S|\times|S|$ 的下三角矩阵。矩阵 $\mathbf{A}_ {S \cup {\lbrace i\rbrace }}$ 记作：<br> 

$$\mathbf{A}_ {S\cup\lbrace i\rbrace}=
\begin{bmatrix}
A_ \mathcal{S} & a_i \\
\boldsymbol{a}_ i ^ \top & a_{ii} \\
\end{bmatrix}.(式3-5)$$

上式中 $a_i$ 的元素是 $v_i^{\top}v_j$， $\forall j\in\mathcal{S}$。而 $a_ {ii}=\boldsymbol{v}_ {i} ^{\top} \boldsymbol{v}_ {i} = 1$。矩阵 $\mathbf{A}_ {S \cup {\lbrace i\rbrace }}$ 的Cholesky分解可写作：

$$\mathbf{A}_ {S \cup {\lbrace i\rbrace}}=
\begin{bmatrix}
L & 0 \\
c_ i ^ \top & d_i \\
\end{bmatrix}
\begin{bmatrix}
L & 0 \\
c_ i^ \top & d_i \\
\end{bmatrix} ^ \top.（式3-6）$$

其中 $c_i$ 和 $d_i$ 未知。由式(3-5)和式(3-6)可得：

$$\mathbf{A}_ {S \cup {\lbrace i\rbrace}}=
\begin{bmatrix}
A_S & a_i \\
\boldsymbol{a}_i^\top & 1
\end{bmatrix}=
\begin{bmatrix}
\boldsymbol{LL}^\top & \boldsymbol{Lc}_i \\
\boldsymbol{c}_i^\top\boldsymbol{L}^\top & \boldsymbol{c}_i^\top\boldsymbol{c}_i+d_i^2
\end{bmatrix}.（式3-7）$$

即可得： $a_i =Lc_i$ 和 $1=c_{i}^{T}c_{i}+d_{i}^{2}$。<br>
L和 $a_i$ 都是已知的，只需求出 $c_i$ 和 $d_i$。由 $c_{i}=L^{-1}a_{i}$ 可算出 $d_i^2=1-c_i^\top c_i$，由下三角矩阵和行列式定义可知：

$$det\left(
\begin{bmatrix}
L & 0 \\
c_i^\top & d_i
\end{bmatrix}\right)=det(L)\times d_i.（式3-8）$$

由于 $\det(\mathrm{XY})=\det(\mathrm{X})\det(\mathrm{Y})$，可得到

$$det(\mathbf{A}_ {S \cup {\lbrace i\rbrace }})=det\left(
\begin{bmatrix}
\boldsymbol{L} & \boldsymbol{0} \\
\boldsymbol{c}_i^T & d_i
\end{bmatrix}
\begin{bmatrix}
\boldsymbol{L} & \boldsymbol{0} \\
\boldsymbol{c}_i^\top & d_i
\end{bmatrix}^\top\right)=det(\boldsymbol{L})^2\times d_i^2.（式3-9）$$

贪心算法的公式（式3-4）可等价为

$$\arg\max_{i \in R} \theta\cdot reward_i + (1 - \theta) \cdot \mathrm{log}d_ i ^2.（式3-10）$$

DPP算法在理论上为多样性优化提供了优雅且有效的建模框架，其在实际推荐系统中的应用效果也已得到多项研究验证，主要优势如下：
- 全局多样性建模能力
DPP以集合为建模单位，通过行列式计算显式刻画子集中各元素之间的“排斥性”，使得最终推荐结果在整体上更具多样性，而非仅依赖局部两两相似度，如贪婪算法常见的“最近冗余排斥”。

- 理论支持与泛化能力强
DPP本质上是一种概率模型，具备良好的数理结构，可与深度学习模型、图结构建模等方式结合，适应复杂推荐场景（如视频推荐、序列建模等）。

- 在多任务推荐中的广泛适用性
DPP已被成功应用于摘要生成、图像检索、社交媒体内容排序等任务，表明其在多模态、多任务推荐中的可迁移性与通用性较强。

尽管DPP在实现推荐多样性方面具备独特优势，但其在应用过程中仍存在一定挑战：
- 计算复杂度较高
标准DPP MAP推断需对核矩阵求行列式，时间复杂度通常为O($M^4$)，即便使用贪婪近似也为O($M^3$)，在面对大规模推荐候选集时，难以直接部署于实时推荐系统。

- 对相似度函数依赖性强
DPP的建模效果在很大程度上取决于相似度函数或嵌入向量的质量，若项目特征表示不准确，可能会导致推荐结果的质量下降。

- 难以处理行为稀疏的用户
在用户行为数据较少的场景下，无法有效构建高质量的用户兴趣表示，进而影响项目相关性打分和DPP核矩阵构建，降低推荐性能。

## 3.3 本节小结
本章围绕推荐系统中的多样性问题展开了系统性探讨。首先指出了以准确性为唯一优化目标的传统推荐方法在实际应用中的局限性，阐明了推荐多样性在用户体验提升、平台生态优化和社会价值等多层面的重要意义。随后详细介绍了两种经典的多样性增强算法：最大边际相关性（MMR）与行列式点过程（DPP）。MMR通过平衡用户兴趣相关性与候选项间的冗余性，实现了推荐准确性与多样性的局部权衡；而DPP作为概率建模方法，具备更强的全局多样性建模能力，并在理论与实践中均展现出良好性能。

尽管这两种算法在提升推荐多样性方面各具优势，但也分别存在计算开销、冷启动敏感、个性化调节等方面的挑战。为更深入理解它们在不同推荐场景下的实际表现，下面将围绕真实数据集设计实验，构建一个基于用户的协同过滤算法，MMR和DPP算法增强多样性的推荐系统，对MMR与DPP在准确性与多样性指标上的效果进行量化评估与对比分析。

# 4.系统设计与算法实现
## 4.1 系统设计概述
### 4.1.1 设计目标
本系统旨在构建一个集准确性与多样性于一体的推荐系统框架，通过基于用户的协同过滤算法生成初始推荐列表，并引入多样性重排序机制提升推荐内容的覆盖广度与新颖性，具体目标包括：<br>
1.实现用户-项目评分的基础协同过滤推荐；<br>
2.引入多样性重排序机制（MMR 与 DPP）；<br>
3.支持多样性与准确性指标的实验评估；<br>
4.提供简洁、模块化的实现结构便于扩展与调试。

### 4.1.2 系统架构与模块划分
系统整体架构如图4-1所示，主要分为以下几个模块：<br>
数据加载与预处理模块：负责读取、清洗并格式化原始数据。<br>
协同过滤推荐模块：基于用户或物品相似度生成初始推荐列表。<br>
多样性增强模块：使用 MMR 和 DPP 对推荐列表进行重排序。<br>
评估模块：提供准确性与多样性相关指标计算与可视化支持。<br> 
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/4.1.png" width="400"/>
</div>
<p align="center">图4-1 系统整体架构</p>

## 4.2 数据集与预处理
### 4.2.1 MovieLens和Anime数据集介绍
MovieLens是由明尼苏达大学GroupLens研究组发布的经典开源数据集[17]，广泛应用于推荐系统算法的开发与验证。其核心价值在于丰富的用户-电影交互数据与细粒度的电影内容元数据，为研究内容多样性推荐提供了多维分析基础。<br>
该小型数据集包含9742部电影中的100836个评级和3683个标签应用程序。这些数据是由610名用户在1996年3月29日至2018年9月24日期间创建的。该数据集生成于2018年9月26日，评分范围为0.5-5，以0.5分为增量。<br>
Anime数据集[21]来自myanimelist.net，专注于动漫推荐系统研究，涵盖用户评分与动漫内容元数据，适用于内容多样性分析与推荐算法开发。该数据集包含来自12,294部动漫的73,516名用户的用户偏好数据信息，评分1-10，若用户观看了未评分，则评分为-1。

### 4.2.2 数据清洗与特征构建
在数据预处理与特征构建方面。主要内容是过滤无效记录，去除如动漫数据中评分为-1的用户未评分记录，仅保留有效评分以提高数据质量。对用户与物品数据进行采样，降低计算复杂度，保证交互密度，从动漫数据中选取评分行为最活跃的前1000名用户及前1000部作品。随后对用户与物品ID进行重映射，将其转化为从0开始的连续整数，以优化稀疏矩阵存储结构并减少索引碎片。<br>
在特征构建方面，采用MultiLabelBinarizer对电影或动漫的类型信息（如“动作|科幻”）进行One-Hot编码，得到离散的二进制特征表示，并基于该特征向量计算物品间的内容相似度矩阵，作为后续基于内容推荐与多样性建模的输入基础。

## 4.3 基础推荐模块实现
### 4.3.1 用户相似度计算方法
基于协同过滤中的用户相似度，使用余弦相似度计算用户之间的兴趣相似性：<br>
$\cos (i, j) = \frac{i \cdot j}{\| i \| \times \| j \|}$，其中i与j表示用户的评分向量。

### 4.3.2 评分预测与推荐生成
预测公式采用加权平均评分方式，根据相似用户的历史评分和相似度权重进行评分预测。对目标用户未评分的物品进行排序并推荐前k个物品。
```python
# 预测评分
R_pred = np.zeros((num_users, num_items))
mask_union = mask_train | mask_test  # 取并集
for u in range(num_users):
    for i in range(num_items):
        if mask_union[u, i]:
            neighbors_u = neighbors[u]
            mask_neighbors = R_train[neighbors_u, i] > 0
            if np.sum(mask_neighbors) == 0:
                R_pred[u, i] = user_mean[u]
            else:
                sim_u = similarity[u, neighbors_u][mask_neighbors]
                ratings_u = R_train[neighbors_u, i][mask_neighbors]
                R_pred[u, i] = np.dot(sim_u, ratings_u) / np.sum(np.abs(sim_u))
```
</div>
<p align="center">图4-2 评分预测程序实例</p>

## 4.4 多样性算法实现
### 4.4.1 MMR算法设计与实现
MMR算法通过平衡相关性（预测评分）和多样性（物品间相似性）优化推荐列表，实现步骤如下：
1. 候选集排序与初始化
- 首先将候选物品（如协同过滤预测评分Top-N）按评分从高到低排序。
- 推荐列表S初始化为评分最高的物品。
2. 迭代选择
- 每轮从剩余候选物品中，计算每个物品的MMR得分：
  - 相关性部分：物品的协同过滤预测评分。
  - 多样性部分：该物品与已选物品集合S中最相似物品的相似度。
  - 综合得分公式： $MMR_i = \theta \cdot reward _i - (1 - \theta) \cdot \max _{j \in S} sim(i,j)$。
    其中$\theta$为相关性与多样性的权衡参数，$\text{sim}(i, j)$为物品i与j的相似度。
- 选择MMR得分最高的物品加入推荐列表S，并从候选集R中移除。
- 重复步骤2，直到推荐列表达到指定长度k。
- 输出最终的推荐列表S。

### 4.4.2 DPP算法设计与实现
DPP算法使用核矩阵建模项目之间的相似性，通过最大化子集行列式选择代表性强、冗余度低的推荐项。<br>

由3.2.2章节的k-DPP应用于推荐系统重排的算法推导，可得求解k-DPP的贪心算法流程：<br>
1. 输入：n个物品的向量表征 $v_{1}, \cdots, v_{n} \in \mathbb{R}^{d}$ 和分数 $reward_1$,… , $reward_n$。<br>
2. 计算的相似度矩阵A，它的第(i,j)个元素等于 $a_{ij}=v_{i}^{T}v_{j}$。<br>
3. 选中reward分数最高的物品，记作i。初始化集合 $S= \lbrace i \rbrace$ 和1 × 1的矩阵L=[1]。（由于 $a_{ii}=v_ i ^\top v_i=1$，此时 $\mathbf{A}_ {S} = [a_{ii} = L L^\top]$）
4. 做循环，从t=1到k-1：<br>
    (a)对于每一个i∈R：<br>
        Ⅰ.行向量 $[\mathrm{a_{i}^\top},1]$ 是矩阵 $\mathbf{A}_ {S \cup \lbrace i \rbrace}$ 的最后一行。<br>
        Ⅱ.求解线性方程组 $a_i=Lc_i$，得到 $c_i$。<br>
        Ⅲ.计算 $d_i^2=1-c_i^\top c_i$<br>
    (b)求解(式4.8)： $\mathrm{i ^\star = \arg \max_{i \in \mathcal{R}} \theta \cdot reward_i + (1-\theta) \cdot \log d_i ^2}$。<br>
    (c)更新集合 $\mathcal{S}\leftarrow\mathcal{S}\cup\lbrace\mathrm{i}^{\star}\rbrace$。<br>
    (d)更新下三角矩阵：

$$\mathrm{L} \leftarrow 
 \begin{bmatrix} 
 \mathrm{L} & 0 \\
 \mathrm{c}_ {\mathrm{i} ^ \star} ^ \mathrm{T} & \mathrm{d}_ {\mathrm{i} ^ \star} 
 \end{bmatrix}
$$
 
5. 返回集合S，其中包含k个物品。

## 4.5 关键技术难点与解决方案
系统实现过程中，主要遇到数据稀疏性、大规模数据处理以及DPP算法高计算复杂度等关键技术难题。<br>
在协同过滤中创建的用户-物品评分矩阵高度稀疏，容易导致相似度计算出现偏差。为此系统通过对电影、动漫ID、用户ID重映射，减少无评分且占用矩阵空间的物品，将稀疏矩阵有效转换为稠密矩阵，从而提升了数据利用率和计算精度。<br>
针对动漫数据集规模较大、直接处理易导致内存溢出的实际问题，系统采用分批计算用户相似度的方法，有效降低了内存占用，保证了大规模数据下的可行性。<br>
DPP算法在求解过程中涉及行列式计算和矩阵分解，计算复杂度较高。对此系统使用了Hulu论文中的贪心算法，结合Cholesky分解技术，实现了行列式的快速计算，显著提升了DPP算法在实际推荐场景中的运行效率。

 
# 5. 实验评估与结果分析
## 5.1 实验设计
### 5.1.1 评价指标设计
在本研究中采用了全面的评价指标体系，同时考虑推荐系统的准确性和多样性：<br>
准确性指标：<br>
1.RMSE (Root Mean Square Error)：衡量预测评分与真实评分之间的偏差，数值越小表示推荐准确性越高。<br>
2.MAE (Mean Absolute Error)：评估预测评分与实际评分之间的平均绝对误差。<br>
3.平均评分：推荐列表中物品的平均预测评分，反映推荐物品的整体质量。<br>
4.NDCG（Normalized Discounted Cumulative Gain）：考虑推荐列表位置的准确性指标，值越高说明高评分物品排名越靠前。<br>
 多样性指标：<br>
1.内部相似性 (ILS, Intra-List Similarity) ：推荐列表中物品之间的平均相似度，值越低表示多样性越高。<br>
2.多样性：采用ILS（Intra-List Similarity）补集，值越高表示多样性越好。<br>
3.类别覆盖率（Category Coverage）：统计推荐列表中覆盖的类别数量比例，反映推荐内容的多样性广度。

### 5.1.2 实验环境与参数配置
本实验构建的推荐系统在Windows10操作系统上开发的，开发工具采用Pycharm，编程语言使用Python，所采用的核心库主要有Pandas、NumPy、Scikit-learn、SciPy、Matplotlib等，系统硬件环境如表5-1所示。

<p align="center">表5-1 系统硬件环境</p>

| 系统硬件环境       | 型号    |
|-----------|-----------------|
| 处理器     | Intel i5-11300H |
| RAM       | 16G             |
| ROM       | 512G            |

推荐系统中，采用的数据集有MovieLens和Anime。MovieLens包含约10万条用户评分记录，具有明确电影类别；Anime进行采样后包含约41万条，含多标签与风格。协同过滤推荐用户对物品预测评分Top-50，多样性算法对协同过滤推荐结果进行多样性优化，并根据各自评分公式推荐出Top-10物品。其中MMR与DPP中调节相关性与多样性的参数Theta设置为0-1，步长为0.1。

### 5.1.3对照实验方案
为全面评估多样性算法的效果，我们设计了以下对照实验：<br>
1. 基准方法 ：基于用户的协同过滤（UserCF），直接选择预测评分最高的物品作为推荐结果。
2. MMR算法 ：在协同过滤结果基础上，使用最大边际相关性算法进行重排序，平衡相关性和多样性。
3. DPP算法 ：在协同过滤结果基础上，使用行列式点过程算法进行多样性推荐。

对于MMR和DPP算法，我们测试了不同θ值（从0到1，步长为0.1）的效果，以分析参数对推荐结果的影响。<br>

## 5.2 实验结果
### 5.2.1 准确性评估（RMSE、NDCG等）
协同过滤基准性能：<br>
<p align="center">表5-2 MovieLens数据集协同过滤准确度预测结果</p>

| 评估指标       | 数值     |
|----------------|----------|
| RMSE           | 0.7822   |
| MAE            | 0.5006   |
| 相关系数       | 0.6617   |
| 准确率         | 0.4230   |

<p align="center">表5-3 Anime数据集协同过滤准确度预测结果</p>

| 评估指标       | 数值     |
|----------------|----------|
| RMSE           | 1.4480   |
| MAE            | 1.1165   |
| 相关系数       | 0.3757   |
| 准确率         | 0.2896   |

多样性算法的准确性表现：<br>
从图5-4和图5-5可以观察到，随着Theta值的增加（更注重相关性），MMR和DPP算法的平均评分和NDCG值都呈现上升趋势，推荐准确度整体提升，MMR在中高Theta准确性下均优于DPP。<br>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/5.4.png">
</div>
<p align="center">图5-4 MovieLens数据集MMR和DPP算法准确性结果</p>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/5.5.png">
</div>
<p align="center">图5-5 Anime数据集MMR和DPP算法准确性结果</p>

### 5.2.2 多样性评估（ILS多样性、类别多样性）
根据多样性评估结果图5-6和5-7，多样性算法对协同过滤推荐结果的多样性指标具有显著提升作用。<br>
从整体来说，多样性指标呈下降趋势。表明随着Theta减小，推荐列表内部差异性增强，MMR与DPP均有效提升了列表多样性。类别覆盖率在Anime数据集上波动较大，但大体上和MovieLens相似呈下降趋势，DPP在大部分Theta下覆盖率高于MMR。

<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/5.6.png">
</div>
<p align="center">图5-6 MovieLens数据集MMR和DPP算法多样性结果</p>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/5.7.png">
</div>
<p align="center">图5-7 Anime数据集MMR和DPP算法多样性结果</p>

## 5.3 结果分析与讨论
### 5.3.1 MMR与DPP算法比较
从准确性表现来看，MMR算法在准确性指标（平均评分与NDCG）上表现更为稳定，其优化目标直接关联用户偏好，因此在个性化推荐场景中能提升推荐结果的精准度。而DPP算法在部分参数设定下，准确性略低于MMR，表明其权衡多样性的设计可能对准确性产生轻微抑制。<br>
从多样性表现来看，MMR算法的局限性体现在类别多样性较低，因其倾向于选择相似性高的项目以满足核心用户需求。DPP算法通过行列式点过程的数学特性，显著提升了推荐结果的多样性和覆盖率，尤其适合需要探索用户潜在兴趣的场景。<br>
从计算复杂度来看，MMR算法计算复杂度较低，实现简单，适合大规模数据下的实时推荐；DPP算法计算复杂度较高，对计算资源要求较高，可能限制其在超大规模系统中的应用。<br>
从适用场景来看，MMR算法更适用于准确性优先的个性化推荐系统（如电商精准推荐），其稳定性与高效性能够满足核心业务需求。DPP算法适合多样性优先的探索式推荐（如新闻流或内容发现平台），通过牺牲部分准确性换取长尾内容的曝光，增强用户体验的新颖性。


### 5.3.2 多样性与准确性权衡分析
从相关性-多样性权衡图可以看出，两种算法都呈现出明显的帕累托前沿曲线，表明准确性和多样性之间存在权衡关系，在Theta≈0.5附近能达到满意的推荐质量和多样性。<br>
DPP在牺牲较少准确性的同时获得更高多样性，适合对内容覆盖范围有要求的推荐应用。MMR适合在尽量保证准确性的前提下略微提升多样性。<br>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/5.8.png">
</div>
<p align="center">图5-8 MovieLens数据集MMR和DPP算法相关性-多样性权衡关系</p>
<div align=center>
<img src="https://github.com/JXW02/graduation_project/blob/main/paper_images/5.9.png">
</div>
<p align="center">图5-9 Anime数据集MMR和DPP算法相关性-多样性权衡关系</p>

### 5.3.3 实验启示与改进方向
实验结果表明多样性算法在不同数据集上的表现存在一定差异，说明数据本身的特性（如类别分布、用户兴趣的多元性、评分密度等）会影响多样性推荐算法的效果。在实际应用中应结合具体数据集的结构和业务需求，灵活选择和调整多样性增强方法。<br>
实验验证了Theta参数在多样性与相关性权衡作用。合理调节Theta值，可以在保证推荐准确性的同时，有效提升推荐列表的多样性。未来可以考虑引入用户个性化的动态调参机制，根据用户的历史行为、兴趣变化和反馈信息，自动调整多样性权重，实现“千人千面”的多样性推荐。还可以结合上下文信息（如时间、场景、设备等），动态优化多样性参数，提升推荐系统的灵活性和适应性。<br>
MMR和DPP算法各有优劣，MMR算法实现简单、计算效率高，适合大规模实时推荐场景，但在类别覆盖率和全局多样性方面存在一定局限；DPP算法则在提升推荐结果的整体多样性和类别覆盖率方面表现突出，但计算复杂度较高，对系统资源要求较大。未来可以尝试将两种算法进行融合，或结合其他多样性增强策略，设计出兼具高效性和高多样性的混合推荐方法。

# 6. 总结与展望
## 6.1 研究工作总结
本研究围绕如何在推荐系统中提升推荐内容的多样性展开，设计并实现了一个结合协同过滤与多样性增强算法的推荐系统。主要研究工作与成果如下：<br>
（1）系统设计与实现：构建了一个完整的推荐系统框架，支持用户协同过滤推荐，并集成了两种多样性优化算法——MMR和DPP。<br>
（2）多样性增强方法研究：MMR算法通过在推荐排序中平衡相关性与多样性，有效提升了推荐内容间的差异性；DPP算法基于概率建模选择信息互补的物品集合，表现出更高的多样性覆盖能力。<br>
（3）评价指标与实验分析：从准确性（RMSE、MAE、平均分数、NDCG）与多样性（ILS多样性、类别覆盖率）两个维度对算法性能进行了系统评估，并在Anime与MovieLens两个真实数据集上开展实验，验证了所提方法的有效性。<br>
（4）权衡分析与启示：通过调节参数Theta，发现准确性与多样性之间存在明显的非线性平衡关系，不同算法适用于不同应用场景，为实际系统部署提供了策略参考。<br>
本研究验证了在传统协同过滤算法基础上引入多样性控制机制的可行性与有效性，为提升推荐系统用户体验与内容覆盖提供了技术路径。

## 6.2 存在的问题与不足
当今多样性问题作为推荐系统热门研究话题之一，本文所研究并实现的多样性算法对多样性均有显著提升效果，但依然存在以下几点不足之处：
1. 个性化多样性未充分考虑：当前多样性控制主要依赖全局参数Theta，未针对不同用户的偏好多样性进行定制，缺乏用户个性化建模。
2. 多样性算法复杂度差异较大：DPP在推荐时涉及矩阵行列式计算，计算复杂度较高，在大规模场景中效率仍有待提升。
3. 实验数据集范围有限：目前实验仅基于两个静态公开数据集，缺乏在实际业务环境中的部署与在线评估，难以全面验证算法的适应性。
4. 推荐目标维度有限：当前评估仅关注准确性与多样性两个维度，未考虑新颖性、覆盖率、用户满意度等更丰富的评价角度。


## 6.3未来工作展望
为进一步提升推荐系统的实用性与用户满意度，本研究从算法优化、数据融合及系统部署等维度提出以下未来研究方向：<br>
1. 动态个性化多样性调节机制<br>
基于用户行为特征与兴趣演化规律，设计动态自适应多样性调节模型。通过引入时间序列分析（如LSTM）与强化学习框架，实时捕捉用户偏好变化，实现“千人千面”的多样性推荐。例如，针对新用户侧重探索多样性内容以快速构建兴趣画像，而对长期活跃用户则动态平衡相关性反馈与多样性探索需求。<br>
2. 多源异构信息融合的智能推荐架构<br>
整合社交关系网络、时空上下文信息及隐式反馈（如点击、停留时长），构建多模态融合推荐模型。具体可通过图神经网络（GNN）建模用户-物品-社交三元交互关系，结合注意力机制动态加权不同数据源的贡献，从而提升推荐的全面性与场景适应性。此方向需重点解决异构数据对齐与噪声过滤问题。<br>
3. 基于Pareto前沿的多目标协同优化框架<br>
针对推荐系统中准确性、多样性、新颖性等指标的复杂权衡关系，提出多目标联合优化策略。采用进化算法（如NSGA-II）或梯度优化方法，在Pareto前沿上寻找非支配解集，为用户提供可交互的个性化权衡界面。此外，可结合元学习技术，自适应调整目标权重以适配不同应用场景。<br>
4. 面向大规模数据的高效推荐系统设计<br>
为应对工业级推荐场景的海量数据处理需求，探索轻量化与分布式算法优化：<br>
算法层面：设计稀疏DPP的快速近似计算方法，利用矩阵低秩分解降低计算复杂度；<br>
架构层面：结合分布式计算框架（如Spark、Flink）与模型压缩技术（如量化、剪枝），实现实时推理与资源高效利用；<br>
存储优化：采用增量更新策略，减少全量数据重计算的开销。
5. 基于真实场景的在线实验与用户行为验证<br>
在电商平台或流媒体服务中部署推荐系统，开展端到端的A/B测试与用户行为分析：<br>
实验设计：将用户随机分为对照组（传统推荐）与实验组（多样性增强推荐），量化对比点击率、转化率及用户留存率等核心指标；<br>
反馈机制：通过问卷调查与眼动追踪实验，捕捉用户对多样性推荐的主观满意度，构建“用户体验-算法性能”的闭环优化链路。<br>

上述方向既延续了本研究的核心成果，又突破了现有局限性，为推荐系统在多样化、个性化及智能化方向的发展提供了理论参考与实践路径。未来工作可进一步结合领域知识迁移、因果推理等前沿技术，推动推荐系统从“精准推荐”向“价值引导”的范式升级。


# 参考文献
[1]杨文波.基于信息技术的个性化推荐系统设计与实现[C]//中国智慧工程研究会.2024工程技术应用与施工管理交流会论文集（下）.杭州善淼科技有限公司;2024:109-111.  
[2]毕文婧.个性化推荐系统中用户应对信息同质化问题的实证研究[D].青岛大学,2024.  
[3]徐靖宜.用户生成内容与算法推荐机制在短视频平台上的作用[J].记者摇篮,2025,(03):15-17.  
[4]Carbonell J, Goldstein J. The use of MMR, diversity-based reranking for reordering docu-ments and producing summaries[C]//Proceedings of the 21st annual international ACM SIGIR conference on Research and development in information retrieval. 1998: 335-336.  
[5]Borodin A, Jain A, Lee H C, et al. Max-sum diversification, monotone submodular func-tions, and dynamic updates[J]. ACM Transactions on Algorithms (TALG), 2017, 13(3): 1-25.  
[6]Chen L, Zhang G, Zhou E. Fast greedy map inference for determinantal point process to improve recommendation diversity[J]. Advances in Neural Information Processing Systems, 2018, 31.  
[7]余江龙,宋腾飞,汪德超,等.个性化推荐系统研究方法综述[J].电脑知识与技术,2024,20(10):46-49.  
[8]杨明远.基于知识图谱的个性化音乐推荐系统的设计与实现[D].沈阳工业大学,2024.  
[9]Jafarkarimi H, Sim A T H, Saadatdoost R. A naive recommendation model for large databases[J]. International Journal of Information and Education Technology, 2012, 2(3): 216.  
[10]Ricci F, Rokach L, Shapira B, et al. 推荐系统: Recommender systems handbook: 技术､评估及高效算法[M]. 北京: 机械工业出版社, 2015:216-217.  
[11]俞军.基于协同过滤的推荐系统方法研究[D].大连交通大学,2024.  
[12]王宇哲.基于内容的电影推荐算法研究[J].信息系统工程,2023,(12):117-120.  
[13]徐文涛,王诚.基于降低数据稀疏度的协同过滤算法[J].计算机技术与发展,2024,34(05):170-174.  
[14]Çano E, Morisio M. Hybrid recommender systems: A systematic literature review[J]. Intel-ligent data analysis, 2017, 21(6): 1487-1524.  
[15]Zhang S, Yao L, Sun A, et al. Deep learning based recommender system: A survey and new perspectives[J]. ACM computing surveys (CSUR), 2019, 52(1): 1-38.  
[16]Huang P S, He X, Gao J, et al. Learning deep structured semantic models for web search using clickthrough data[C]//Proceedings of the 22nd ACM international conference on In-formation & Knowledge Management. 2013: 2333-2338.  
[17]魏胤楠,陈越昆,宋柏直,等.基于压缩-激励网络双塔模型的卷烟推荐算法[J].云南师范大学学报(自然科学版),2024,44(01):30-34.  
[18]彭迎涛,孟小峰,杜治娟.多样化推荐综述[J].计算机研究与发展,2025,62(02):285-313.  
[19]Macchi O. The coincidence approach to stochastic point processes[J]. Advances in Applied Probability, 1975, 7(1): 83-122.  
[20]Harper F M, Konstan J A. The movielens datasets: History and context[J]. Acm transactions on interactive intelligent systems (tiis), 2015, 5(4): 1-19.  
[21]Cooper Union. Anime Recommendations Database[EB/OL]. https://www.kaggle.com/datasets/CooperUnion/anime-recommendations-database/data, 2017-12-03.
